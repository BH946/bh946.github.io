---
title:  "[Python]ë¹„ì„ í˜• ë°©ì •ì‹ - ì´ë¶„ë²•, ë‰´í„´ë²•, í• ì„ ë²•"
categories : [Numerical_Analysis]
tag : [ìˆ˜ì¹˜í•´ì„, ì´ë¶„ë²•, ë‰´í„´ë²•, í• ì„ ë²•]
toc: true
toc_sticky: true
author_profile: false
sidebar:
  nav: "docs"
typora-root-url: ../../..
---

<head>
  <style>
    table.dataframe {
      white-space: normal;
      width: 100%;
      height: 240px;
      display: block;
      overflow: auto;
      font-family: Arial, sans-serif;
      font-size: 0.9rem;
      line-height: 20px;
      text-align: center;
      border: 0px !important;
    }

    table.dataframe th {
      text-align: center;
      font-weight: bold;
      padding: 8px;
    }
    
    table.dataframe td {
      text-align: center;
      padding: 8px;
    }
    
    table.dataframe tr:hover {
      background: #b8d1f3; 
    }
    
    .output_prompt {
      overflow: auto;
      font-size: 0.9rem;
      line-height: 1.45;
      border-radius: 0.3rem;
      -webkit-overflow-scrolling: touch;
      padding: 0.8rem;
      margin-top: 0;
      margin-bottom: 15px;
      font: 1rem Consolas, "Liberation Mono", Menlo, Courier, monospace;
      color: $code-text-color;
      border: solid 1px $border-color;
      border-radius: 0.3rem;
      word-break: normal;
      white-space: pre;
    }

  .dataframe tbody tr th:only-of-type {
      vertical-align: middle;
  }

  .dataframe tbody tr th {
      vertical-align: top;
  }

  .dataframe thead th {
      text-align: center !important;
      padding: 8px;
  }

  .page__content p {
      margin: 0 0 0px !important;
  }

  .page__content p > strong {
    font-size: 0.8rem !important;
  }

  </style>
</head>


# ë¹„ì„ í˜• ë°©ì •ì‹

* 2ì°¨ ì´ìƒ ë°©ì •ì‹ë“¤ì„ ì˜ë¯¸(ê³¡ì„ )

<br>

## ì´ë¶„ë²•



### ì´ë¶„ë²• Bisection Method

* ì—°ì†í•¨ìˆ˜ì˜  ì†ì„±ì„  í™œìš©  

* ê° ë‹¨ê³„ì—ì„œ êµ¬ê°„ [ğ‘, ğ‘]ì™€ ğ‘¢ = ğ‘“(ğ‘) , ğ‘£ = ğ‘“(ğ‘)ì˜ ê°’ì´ ì£¼ì–´ì§„ë‹¤.  

  * ì´ë•Œ ğ‘¢ì™€ ğ‘£ëŠ”  ğ‘¢ğ‘£  <  0ì„ ë§Œì¡±(ë¶€í˜¸ê°€ ë‹¤ë¥´ë‹¤ëŠ” ê²ƒ)  

* ì´ íêµ¬ê°„ì˜  ì¤‘ì ì¸  $ğ‘ = \frac{1}{2}(a+b)$ ë¥¼ ì •í•˜ê³ , ğ‘¤ = ğ‘“(ğ‘)ë¥¼ êµ¬í•œë‹¤.  

* ìš°ì—°íˆ ğ‘“(ğ‘)=0ì´ë¼ë©´ ì•Œê³ ë¦¬ì¦˜ ì¢…ë£Œ í›„ ê°’ ë°˜í™˜  

* ë³´í†µì€ ğ‘¤  â‰   0,    ğ‘¤ğ‘¢  <  0 || ğ‘¤ğ‘£  <  0


* if ğ‘¤ğ‘¢  <  0 ?

  * ğ‘“ì˜ ê·¼ì´ êµ¬ê°„  [ğ‘, ğ‘]ì— ì¡´ì¬í•¨

  * êµ¬ê°„ì„ ì¶•ì†Œí•˜ì—¬  ê³„ì†  ì§„í–‰

*  If ğ‘¤ğ‘¢  >  0 ?

  * ğ‘“ì˜ ê·¼ì´ êµ¬ê°„ ğ‘, ğ‘ ì‚¬ì´ì— ì¡´ì¬í•˜ëŠ”ì§€ì˜  ì—¬ë¶€ë¥¼  ì•Œ  ìˆ˜ ì—†ìŒ.

  * ê·¸ëŸ¬ë‚˜ ğ‘¤ğ‘£  <  0ì´ë¯€ë¡œ  [ğ‘, ğ‘]ì—  ğ‘“ì˜  ê·¼ì´  ë°˜ë“œì‹œ  ì¡´ì¬, êµ¬ê°„ì„  ì¶•ì†Œí•˜ì—¬  ê³„ì† ì§„í–‰


* êµ¬ê°„ì˜ í¬ê¸°ê°€ ì¶©ë¶„íˆ ì¤„ì–´ë“¤ ë•Œê¹Œì§€ ë°˜ë³µ (ex) $|ğ‘ âˆ’ ğ‘| < \frac{1}{2} * 10^{-6}$

  * ì˜¤ì°¨ ë²”ìœ„ ì´ë‚´ì—¬ì•¼ í•œë‹¤ê³  ë³´ë©´ ë¨

* ì´ë•Œ  ê°€ì¥ í•©ë¦¬ì ì¸  ê·¼ì˜ ì¶”ì •ì¹˜ : $\frac{a+b}{2}$


ì´ë¶„ë²•ì˜ ìˆ˜ë ´ì„± ë¶„ì„

* ğ‘“ê°€ $[ğ‘_0, ğ‘_0]$ì˜ ì–‘ ëì—ì„œ ì„œë¡œ ë‹¤ë¥¸ ë¶€í˜¸ì˜ í•¨ìˆ«ê°’ì„ ê°–ëŠ” ì—°ì†í•¨ìˆ˜.

* $[ğ‘_0, ğ‘_0]$ ë‚´ì—  í•œ ê·¼  ğ‘Ÿì´  ì¡´ì¬

* $c_0 = \frac{ğ‘_0+ğ‘_0}{2}$ë¥¼ ê·¼ rì˜ ê·¼ì‚¿ê°’ìœ¼ë¡œ ì¡ìœ¼ë©´ $|r - c_0| â‰¤ \frac{b_0 - a_0}{2}$



```python
import numpy as np
import sympy as sp

def Bisection(f,a,b,e,nmax):
    fa = f.evalf(subs={x:a})
    fb = f.evalf(subs={x:b})
    if(fa*fb>0):
        print("f(a) and f(b) have same signs.")
        return
    err = b-a
    for i in range(1, nmax+1):
        err = err/2
        c = a + err
        fc = f.evalf(subs={x:c})
        if abs(err)<e:
            print("convergence at " +str(i) +", x = "+str((a+b)/2.0)+", f(x) = "+str(fc))
            return
        if (fa*fc<0):
            b=c
            fb=fc
        else:
            a=c
            fa=fc
```

<br>

## ë‰´í„´ë²•



### ë‰´í„´ë²• Newton-Raphson Method

* ë¯¸ë¶„  ê°€ëŠ¥í•œ  í•¨ìˆ˜  ğ‘“ì— ëŒ€í•´  ì ìš©

  * í•¨ìˆ˜  ğ‘“ê°€ ëª¨ë“   ìœ„ì¹˜ì—ì„œ  í•˜ë‚˜ì˜  ê¸°ìš¸ê¸°ë¥¼  ê°€ì§

  * í•¨ìˆ˜  ğ‘“ê°€ ìœ ì¼í•œ  ì ‘ì„ ì„  ê°€ì§



* ğ‘“ì˜  ê·¸ë˜í”„  ìœ„ì˜  í•œ  ì   (ğ‘¥<sub>0</sub>, ğ‘“(ğ‘¥<sub>0</sub>))ì—  ì ‘ì„ ì´  ì¡´ì¬

  * ì ‘ì„ ì€  ì ‘ì  ê·¼ì²˜  í•¨ìˆ˜ì˜  ê³¡ì„ ì—  ëŒ€í•œ ì¢‹ì€  ê·¼ì‚¬



* ë¯¸ë¶„ ì¡°ê±´ : ì—°ì†í•¨ìˆ˜, ì¢Œë¯¸ë¶„ê³„ìˆ˜=ìš°ë¯¸ë¶„ê³„ìˆ˜(ê¸°ìš¸ê¸°ê°€ ë™ì¼)


* ğ‘“ì˜  ê·¸ë˜í”„  ìœ„ì˜  í•œ  ì   (ğ‘¥0, ğ‘“(ğ‘¥<sub>0</sub>))ì—  ì ‘ì„ ì´  ì¡´ì¬

  * ì ‘ì„   : $ğ‘™(ğ‘¥) = ğ‘“â€²(ğ‘¥_0)(ğ‘¥ âˆ’ ğ‘¥_0) + ğ‘“(ğ‘¥_0)$

* ğ‘“ì˜  ê·¼ì—  ëŒ€í•œ  ê·¼ì‚¬ë¡œ  ğ‘™ì˜  ê·¼ì„  ì„ íƒ

* lì˜ ê·¼ : $ x_1 = x_0 - \frac{f(x_0)}{f'(x_0)} $ , $ x_2 = x_1 - \frac{f(x_1)}{f'(x_1)} $ , $ x_3 = x_2 - \frac{f(x_2)}{f'(x_2)}  ...  $

* ì´ëŸ¬í•œ  ì ë“¤ì˜  ìˆ˜ì—´ì€  ğ‘“ì˜ ê·¼ìœ¼ë¡œ  ìˆ˜ë ´

**ë‰´í„´ë²• - ì´ˆê¸°ê°’ ì„¤ì •(ë‚˜ìœ ì´ˆê¸°ê°’)**

* ë°œì‚°, í‰í‰í•œ ì , ìˆœí™˜ ê·¸ë˜í”„ëŠ” ë‚˜ìœ ì´ˆê¸°ê°’ì„ ì´ˆë˜í•œë‹¤.

* ì ì ˆí•œ ì´ˆê¸°ê°’ì„ ì„¤ì •í•´ì•¼ ë‰´í„´ë²•ì´ ì •ìƒ ë™ì‘í•œë‹¤.

* ì´ë¶„ë²•ì„ ì ìš©í•˜ì—¬ ê·¼ì´ ì¡´ì¬í•  ë²”ìœ„ íŒŒì•… í›„ ì ì ˆí•œ ì´ˆê¸°ê°’ì„ ì„¤ì •



```python
import numpy as np
import sympy as sp
def Newton(f, fprime, a, nmax, eps, delta):
    fx = f.evalf(subs={x:a})
    for i in range(1, nmax+1):
        fp = fprime.evalf(subs={x:a})
        if(abs(fp)<delta):
            print("small derivative")
            return
        d = fx/fp
        a = a - d
        fx = f.evalf(subs={x:a})
        if(abs(d)<eps):
            print("convergence at "+str(i)+", x = "+str(a)+", f(x) = "+str(fx))
            return
```


```python
x=sp.symbols("x")
f=21*x**3 - 150*x**2 + 41*x - 220
```

<br>

## ì´ë¶„ë²•ê³¼ ë‰´í„´ë²• ì½”ë“œ ë¹„êµ



```python
x = sp.symbols("x")
f = x**3 + 2*x**2 + 10*x + 23
fprime = 3*x**2 + 4*x + 10
print("Bisection") # ì´ë¶„ë²•
Bisection(f,-10,10,1E-7,100)
print("Newton") # ë‰´í„´ë²•
Newton(f,fprime,0,100,1E-7,1E-7)
# ë‰´í„´ì€ 5ë²ˆ, ì´ë¶„ë²•ì€ 28ë²ˆ ë°˜ë³µí–ˆìŒ. ë‰´í„´ì´ í›¨ì”¬ ë¹ ë¦„.
# f(x)ëŠ” ë‰´í„´ì´ í›¨ì”¬ ì‘ìœ¼ë‹ˆê¹Œ ì •ë°€ë„ë„ í›¨ì”¬ ë†’ìŒ.
```

<pre>
Bisection
convergence at 28, x = -2.202034369111061, f(x) = 6.71329234040575e-7
Newton
convergence at 5, x = -2.20203441176566, f(x) = -1.37349444519054e-15
</pre>
<br>

## í• ì„ ë²•



### í• ì„ ë²• Method

* ë‰´í„´ë²•ë§Œí¼  ë¹ ë¥´ê²Œ  ê·¼ìœ¼ë¡œ  ìˆ˜ë ´í•˜ë©´ì„œ, ì‰½ê²Œ  ê³„ì‚°í•˜ëŠ”  ë°©ë²•

  * ë‰´í„´ë²• : $x_{n+1} = x_n - \frac{f(x_n)}{f'(x_n)}$

  * $ğ‘“â€²(ğ‘¥_ğ‘›)$ ì„ ì‰½ê²Œ ê³„ì‚°í•   ìˆ˜ ìˆëŠ”  ê·¼ì‚¿ê°’ìœ¼ë¡œ  êµì²´


* í• ì„ ë²• : $x_{n+1} = x_n - (\frac{x_n-x_{n-1}}{f(x_n)-f(x_{n-1})}) f(x_n) $



```python
import numpy as np
import sympy as sp

def swap(a, b):
    temp = a
    a = b
    b = temp
    return a, b

def Secant(f, a, b, nmax, eps):
    fa = f.evalf(subs={x:a}) # f(a)
    fb = f.evalf(subs={x:b}) # f(b)
    if abs(fa) > abs(fb):
        a, b = swap(a, b)
        fa, fb = swap(fa, fb)
    for i in range(2, nmax+1):
        if abs(fa) > abs(fb):
            a, b = swap(a, b)
            fa, fb = swap(fa, fb)
        d = (b-a)/(fb-fa)
        b = a
        fb = fa
        d = d*fa # a-d í•˜ê¸°ì „ì— epsì™€ ë¹„êµìœ„í•´(ì˜¤ì°¨ë²”ìœ„ í™•ì¸)
        if abs(d) < eps:
            print("convergence at " +str(i) +", x = "+str(a)+", f(x) = "+str(fa))
            return
        a = a-d # ë‹¤ìŒ xê°’ì„ êµ¬í•œê²ƒì„.
        fa = f.evalf(subs={x:a}) # f(a)
```

<br>

## ì´ë¶„ë²•, ë‰´í„´ë²•, í• ì„ ë²• ì „ì²´ ë¹„êµ



```python
x = sp.symbols("x")
# ì‹ 1 : f=21*x**3-150*x**2+41*x-220
# ì‹ 2 : f=22*x**3-25*x**2+21*x-100
f1 = 21*x**3-150*x**2+41*x-220
fprime1 = 63*x**2-300*x+41
f2 = 22*x**3-25*x**2+21*x-100
fprime2 = 66*x**2-50*x+21
print("Bisection") # ì´ë¶„ë²•
Bisection(f1,-10,10,1E-7,100)
Bisection(f2,-10,10,1E-7,100)
print("Newton") # ë‰´í„´ë²•
Newton(f1,fprime1,0,100,1E-7,1E-7)
Newton(f2,fprime2,0,100,1E-7,1E-7)
print("Secant") # í• ì„ ë²•
Secant(f1, -10, 10, 100, 1E-7)
Secant(f2, 0, 1, 100, 1E-7)
```

<pre>
Bisection
convergence at 28, x = 7.07616962492466, f(x) = -1.79966109081769e-5
convergence at 28, x = 1.8966569751501083, f(x) = -4.03194505697596e-6
Newton
convergence at 8, x = 7.07616964170165, f(x) = -1.16819010758179e-13
convergence at 8, x = 1.89665699979684, f(x) = -8.21520068727071e-15
Secant
convergence at 7, x = 7.07616964172657, f(x) = 2.67377372820549e-8
convergence at 12, x = 1.89665702055653, f(x) = 3.39606631760622e-6
</pre>