---
title:  "TCP μ—°κ²° μλ¦½κ³Ό ν•΄μ  κ³Όμ • μ™„λ²½ κ°€μ΄λ“"
categories : [Computer_Network]
tag : [TCP,3-way-handshake,4-way-handshake,λ„¤νΈμ›ν¬,μ—°κ²°μλ¦½,μ—°κ²°ν•΄μ ]
toc: true
toc_sticky: true
author_profile: false
sidebar:
  nav: "docs"
typora-root-url: ../../..
---



**TCP ν”„λ΅ν† μ½μ—μ„ μ—°κ²°μ„ μλ¦½ν•λ” 3-way handshakeμ™€ μ—°κ²°μ„ ν•΄μ ν•λ” 4-way handshake κ³Όμ •μ— λ€ν• μƒμ„Έ μ„¤λ…μ΄λ‹¤.**

<br>

<br>

## TCP μ—°κ²° μλ¦½: 3-way handshake

TCPλ” μ‹ λΆ°μ„± μλ” λ°μ΄ν„° μ „μ†΅μ„ μ„ν•΄ μ—°κ²° μ§€ν–¥μ  ν”„λ΅ν† μ½λ΅ μ„¤κ³„λμ—λ‹¤. μ—°κ²°μ„ μλ¦½ν•κΈ° μ„ν•΄ 3-way handshake κ³Όμ •μ„ κ±°μΉλ‹¤.

<br><br>

### 3-way handshake λ‹¨κ³„λ³„ κ³Όμ •

1. **ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„: SYN ν¨ν‚· μ „μ†΅**

   - ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ— μ—°κ²° μ”μ²­μ„ μ„ν•΄ SYN(Synchronize) ν¨ν‚·μ„ μ „μ†΅ν•λ‹¤
   - μ΄ ν¨ν‚·μ—λ” ν΄λΌμ΄μ–ΈνΈμ μ΄κΈ° μ‹ν€€μ¤ λ²νΈ(ISN)κ°€ ν¬ν•¨λλ‹¤

   ```
   SYN ν¨ν‚· κµ¬μ΅°:
   - ν”λκ·Έ: SYN=1
   - μ‹ν€€μ¤ λ²νΈ: ν΄λΌμ΄μ–ΈνΈ ISN(μ: 100)
   ```

2. **μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ: SYN+ACK ν¨ν‚· μ „μ†΅**

   - μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈμ μ—°κ²° μ”μ²­μ„ μλ½ν•κ³  SYNκ³Ό ACK ν”λκ·Έκ°€ μ„¤μ •λ ν¨ν‚·μ„ μ „μ†΅ν•λ‹¤
   - μ΄ ν¨ν‚·μ—λ” μ„λ²„μ μ΄κΈ° μ‹ν€€μ¤ λ²νΈμ™€ ν΄λΌμ΄μ–ΈνΈ ISN+1 κ°’μ΄ ν¬ν•¨λλ‹¤

   ```
   SYN+ACK ν¨ν‚· κµ¬μ΅°:
   - ν”λκ·Έ: SYN=1, ACK=1
   - μ‹ν€€μ¤ λ²νΈ: μ„λ²„ ISN(μ: 300)
   - ν™•μΈ μ‘λ‹µ λ²νΈ: ν΄λΌμ΄μ–ΈνΈ ISN+1(μ: 101)
   ```

3. **ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„: ACK ν¨ν‚· μ „μ†΅**

   - ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ μ‘λ‹µμ„ ν™•μΈν•κ³  ACK ν¨ν‚·μ„ μ „μ†΅ν•μ—¬ μ—°κ²° μλ¦½μ„ μ™„λ£ν•λ‹¤
   - μ΄ ν¨ν‚·μ—λ” μ„λ²„ ISN+1 κ°’μ΄ ν¬ν•¨λλ‹¤

   ```
   ACK ν¨ν‚· κµ¬μ΅°:
   - ν”λκ·Έ: ACK=1
   - μ‹ν€€μ¤ λ²νΈ: ν΄λΌμ΄μ–ΈνΈ ISN+1(μ: 101)
   - ν™•μΈ μ‘λ‹µ λ²νΈ: μ„λ²„ ISN+1(μ: 301)
   ```

<span style="color:#ff9300">3-way handshakeλ¥Ό ν†µν•΄ μ–‘λ°©ν–¥ ν†µμ‹ μ΄ κ°€λ¥ν• TCP μ—°κ²°μ΄ μλ¦½λλ©°, μ–‘μ½ λ¨λ‘ μƒλ€λ°©μ μ΄κΈ° μ‹ν€€μ¤ λ²νΈλ¥Ό μΈμ§€ν•κ² λλ‹¤.</span>

<br>

<br>

## TCP μ—°κ²° ν•΄μ : 4-way handshake

TCP μ—°κ²°μ„ μΆ…λ£ν•  λ•λ” 4-way handshake κ³Όμ •μ„ ν†µν•΄ μ•μ „ν•κ² μ—°κ²°μ„ ν•΄μ ν•λ‹¤.

<br><br>

### 4-way handshake λ‹¨κ³„λ³„ κ³Όμ •

1. **ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„: FIN ν¨ν‚· μ „μ†΅**

   - ν΄λΌμ΄μ–ΈνΈκ°€ μ—°κ²° μΆ…λ£λ¥Ό μ”μ²­ν•κΈ° μ„ν•΄ FIN(Finish) ν¨ν‚·μ„ μ „μ†΅ν•λ‹¤
   - μ΄ μ‹μ μ—μ„ ν΄λΌμ΄μ–ΈνΈλ” FIN_WAIT_1 μƒνƒλ΅ μ „ν™λλ‹¤

   ```
   FIN ν¨ν‚· κµ¬μ΅°:
   - ν”λκ·Έ: FIN=1, ACK=1
   - μ‹ν€€μ¤ λ²νΈ: ν΄λΌμ΄μ–ΈνΈμ ν„μ¬ μ‹ν€€μ¤ λ²νΈ
   ```

2. **μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ: ACK ν¨ν‚· μ „μ†΅**

   - μ„λ²„λ” ν΄λΌμ΄μ–ΈνΈμ μ—°κ²° μΆ…λ£ μ”μ²­μ„ ν™•μΈν•κ³  ACK ν¨ν‚·μ„ μ „μ†΅ν•λ‹¤
   - μ„λ²„λ” CLOSE_WAIT μƒνƒλ΅ μ „ν™λκ³ , ν΄λΌμ΄μ–ΈνΈλ” FIN_WAIT_2 μƒνƒλ΅ μ „ν™λλ‹¤
   - μ΄ μ‹μ μ—μ„ ν΄λΌμ΄μ–ΈνΈβ†’μ„λ²„ λ°©ν–¥μ μ—°κ²°μ€ μΆ…λ£λμ§€λ§, μ„λ²„β†’ν΄λΌμ΄μ–ΈνΈ λ°©ν–¥μ μ—°κ²°μ€ μ μ§€λλ‹¤

   ```
   ACK ν¨ν‚· κµ¬μ΅°:
   - ν”λκ·Έ: ACK=1
   - ν™•μΈ μ‘λ‹µ λ²νΈ: ν΄λΌμ΄μ–ΈνΈμ μ‹ν€€μ¤ λ²νΈ+1
   ```

3. **μ„λ²„ β†’ ν΄λΌμ΄μ–ΈνΈ: FIN ν¨ν‚· μ „μ†΅**

   - μ„λ²„κ°€ λ‚¨μ€ λ°μ΄ν„°λ¥Ό λ¨λ‘ μ „μ†΅ν• ν›„, μ„λ²„λ„ μ—°κ²° μΆ…λ£λ¥Ό μ„ν•΄ FIN ν¨ν‚·μ„ μ „μ†΅ν•λ‹¤
   - μ„λ²„λ” LAST_ACK μƒνƒλ΅ μ „ν™λλ‹¤

   ```
   FIN ν¨ν‚· κµ¬μ΅°:
   - ν”λκ·Έ: FIN=1, ACK=1
   - μ‹ν€€μ¤ λ²νΈ: μ„λ²„μ ν„μ¬ μ‹ν€€μ¤ λ²νΈ
   ```

4. **ν΄λΌμ΄μ–ΈνΈ β†’ μ„λ²„: ACK ν¨ν‚· μ „μ†΅**

   - ν΄λΌμ΄μ–ΈνΈλ” μ„λ²„μ μ—°κ²° μΆ…λ£ μ”μ²­μ„ ν™•μΈν•κ³  ACK ν¨ν‚·μ„ μ „μ†΅ν•λ‹¤
   - ν΄λΌμ΄μ–ΈνΈλ” TIME_WAIT μƒνƒλ΅ μ „ν™λκ³ , μΌμ • μ‹κ°„(λ³΄ν†µ 2MSL) ν›„μ— CLOSED μƒνƒκ°€ λλ‹¤
   - μ„λ²„λ” ACKλ¥Ό λ°›μ€ μ¦‰μ‹ CLOSED μƒνƒκ°€ λλ‹¤

   ```
   ACK ν¨ν‚· κµ¬μ΅°:
   - ν”λκ·Έ: ACK=1
   - ν™•μΈ μ‘λ‹µ λ²νΈ: μ„λ²„μ μ‹ν€€μ¤ λ²νΈ+1
   ```

π’΅ **TIME_WAIT μƒνƒμ μ¤‘μ”μ„±**:

- μ§€μ—°λ ν¨ν‚·μ΄ λ‚μ¤‘μ— λ„μ°©ν–μ„ λ• μƒλ΅μ΄ μ—°κ²°μ— μν–¥μ„ μ£Όμ§€ μ•λ„λ΅ ν•λ‹¤
- μ„λ²„κ°€ λ§μ§€λ§‰ ACKλ¥Ό μ λ€λ΅ λ°›μ•λ”μ§€ ν™•μΈν•κΈ° μ„ν• μ‹κ°„μ„ μ κ³µν•λ‹¤

<span style="color:#ff9300">4-way handshakeλ” μ–‘λ°©ν–¥ μ—°κ²°μ„ κ°κ° λ…λ¦½μ μΌλ΅ μΆ…λ£ν•λ” κ³Όμ •μΌλ΅, λ°μ΄ν„° μ†μ‹¤ μ—†μ΄ μ•μ „ν•κ² μ—°κ²°μ„ ν•΄μ ν•λ‹¤.</span>

<br>

<br>

## TCP μ—°κ²° μƒνƒ λ³€ν™”

TCP μ—°κ²° μλ¦½κ³Ό ν•΄μ  κ³Όμ •μ—μ„ κ° νΈμ¤νΈλ” λ‹¤μ–‘ν• μƒνƒλ¥Ό κ±°μΉκ² λλ‹¤.

**μ—°κ²° μλ¦½ μ‹ μƒνƒ λ³€ν™”**

```
ν΄λΌμ΄μ–ΈνΈ: CLOSED β†’ SYN_SENT β†’ ESTABLISHED
μ„λ²„: CLOSED β†’ LISTEN β†’ SYN_RECEIVED β†’ ESTABLISHED
```

**μ—°κ²° ν•΄μ  μ‹ μƒνƒ λ³€ν™”**

```
ν΄λΌμ΄μ–ΈνΈ: ESTABLISHED β†’ FIN_WAIT_1 β†’ FIN_WAIT_2 β†’ TIME_WAIT β†’ CLOSED
μ„λ²„: ESTABLISHED β†’ CLOSE_WAIT β†’ LAST_ACK β†’ CLOSED
```

β΅ **TCP μ—°κ²° κ΄€λ¦¬μ ν•µμ‹¬ ν¬μΈνΈ**:

- 3-way handshakeλ” μ—°κ²°μ„ μλ¦½ν•λ” κ³Όμ •
- 4-way handshakeλ” μ—°κ²°μ„ ν•΄μ ν•λ” κ³Όμ •
- κ° κ³Όμ •μ—μ„ μ‹ν€€μ¤ λ²νΈμ™€ ν™•μΈ μ‘λ‹µ λ²νΈλ¥Ό κµν™ν•μ—¬ μ‹ λΆ°μ„±μ„ λ³΄μ¥ν•λ‹¤

<span style="color:#777777">TCPμ μ—°κ²° μλ¦½κ³Ό ν•΄μ  κ³Όμ •μ€ μ‹ λΆ°μ„± μλ” λ°μ΄ν„° μ „μ†΅μ„ μ„ν• κΈ°λ³Έ λ©”μ»¤λ‹μ¦μΌλ΅, λ„¤νΈμ›ν¬ ν”„λ΅κ·Έλλ°κ³Ό λ¬Έμ  ν•΄κ²°μ— μμ–΄ ν•„μμ μΈ μ§€μ‹μ΄λ‹¤.</span>
